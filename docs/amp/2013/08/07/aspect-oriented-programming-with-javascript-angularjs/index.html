<!DOCTYPE html>
<html ⚡="" amp="">
  <head><meta charset="utf-8"><script async src="https://cdn.ampproject.org/v0.js"></script>
    
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="theme-color" content="#263238">

<meta name="generator" content="Hugo 0.55.5">

<link rel="apple-touch-icon" href="https://blog.mgechev.com/images/logo.png">


<link rel="canonical" href="https://blog.mgechev.com/2013/08/07/aspect-oriented-programming-with-javascript-angularjs/">


    
    <style amp-custom=""></style>
    
    <title>Aspect-Oriented Programming with AngularJS - Minko Gechev&apos;s blog</title>
    <style amp-boilerplate="">body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate="">body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    
    
<meta name="description" content="In the following blog post I&#x2019;ll write few words about what is Aspect-Oriented Programming, why I think it will be useful in AngularJS and I&#x2019;m also going to give you a short tutorial for using a simple AOP framework I&#x2019;ve developed.First things first. What is AOP? As we all know OOP is awesome! It gives us many tools for making our development process simpler. Its core principles are Abstraction, Encapsulation, Inheritance and Polymorphism.">

<meta property="og:title" content="Aspect-Oriented Programming with AngularJS - Minko Gechev&apos;s blog">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.mgechev.com/2013/08/07/aspect-oriented-programming-with-javascript-angularjs/">
<meta property="og:site_name" content="Minko Gechev&apos;s blog">
<meta property="og:description" content="In the following blog post I&#x2019;ll write few words about what is Aspect-Oriented Programming, why I think it will be useful in AngularJS and I&#x2019;m also going to give you a short tutorial for using a simple AOP framework I&#x2019;ve developed.First things first. What is AOP? As we all know OOP is awesome! It gives us many tools for making our development process simpler. Its core principles are Abstraction, Encapsulation, Inheritance and Polymorphism.">
<meta property="og:locale" content="ja_JP">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="Minko Gechev&apos;s blog">
<meta name="twitter:url" content="https://blog.mgechev.com/2013/08/07/aspect-oriented-programming-with-javascript-angularjs/">
<meta name="twitter:title" content="Aspect-Oriented Programming with AngularJS - Minko Gechev&apos;s blog">
<meta name="twitter:description" content="In the following blog post I&#x2019;ll write few words about what is Aspect-Oriented Programming, why I think it will be useful in AngularJS and I&#x2019;m also going to give you a short tutorial for using a simple AOP framework I&#x2019;ve developed.First things first. What is AOP? As we all know OOP is awesome! It gives us many tools for making our development process simpler. Its core principles are Abstraction, Encapsulation, Inheritance and Polymorphism.">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "NewsArticle",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id":"https:\/\/blog.mgechev.com\/"
    },
    "headline": "Aspect-Oriented Programming with AngularJS - Minko Gechev\x27s blog",
    "datePublished": "2013-08-07T00:00:00JST",
    "dateModified": "2013-08-07T00:00:00JST",
    "author": {
      "@type": "Person",
      "name": "Minko Gechev\x27s blog"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Minko Gechev\x27s blog",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/blog.mgechev.com\/images/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "description": "In the following blog post I’ll write few words about what is Aspect-Oriented Programming, why I think it will be useful in AngularJS and I’m also going to give you a short tutorial for using a simple AOP framework I’ve developed.\nFirst things first. What is AOP? As we all know OOP is awesome! It gives us many tools for making our development process simpler. Its core principles are Abstraction, Encapsulation, Inheritance and Polymorphism."
  }
</script>


    <style amp-custom="">
      html { font-size: 18px;}@media (max-width: 768px) { html { font-size: 15px; }}body { font-family: Lato,'Hiragino Kaku Gothic Pro',メイリオ,Meiryo,sans-serif; font-size: inherit; margin: 0; color: #263238;}html, body { margin: 0;}a { text-decoration: none; color: #e91e63;}p { margin: 0;}ul,ol { margin: 0; padding: 0;}h1, h2, h3, h4, h5, h6 { margin: 0; font-weight: 700;}h1 { font-size: 1.8rem; line-height: 2rem; margin: 1.5rem 0; }h2 { font-size: 1.4rem; line-height: 2rem; margin: 1.5rem 0; }h3 { font-size: 1.2rem; line-height: 1.5rem; margin: 1.5rem 0; }h4, h5, h6 { font-size: 1rem; line-height: 1.5rem; margin: 1.5rem 0; }.clearfix::after { content: ''; display: block; clear: both;}main { display: block;}/* Layouts */.l-header { padding: .5rem 0; margin-bottom: 2rem; border-bottom: 1px dashed #cfd8dc; text-align: center;}.l-footer { font-size: .8rem; padding: 1rem 0; border-top: 1px dashed #cfd8dc;}.l-container { max-width: 42rem; margin: 0 auto; padding: 0 1rem;}/* Parts:logo */.p-logo { font-family: Lobster, cursive;}.p-logo a { color: #000; font-size: 1.6rem; line-height: 2rem;}/* Parts:section */section { border-top: 2px solid #eceff1; padding: 1.5rem 0;}section>header { text-transform: uppercase; font-weight: 700; margin-bottom: 2rem; text-align: center;}section>header span { display: inline-block; background-color: #000; color: #fff; letter-spacing: 3px; font-size: .7rem; padding: .5rem .75rem;}/* Parts:facts */.p-facts { list-style: none; font-size: .8rem; margin-bottom: 1rem;}.p-facts:last-child { margin-bottom: 0;}.p-facts li { display: inline-block; margin-right: .5rem; text-transform: uppercase;}.p-facts li header { margin-bottom: .25rem; font-weight: 700;}.p-facts li header a { color: #000; text-decoration: underline;}.p-facts li li { display: inline-block; margin-right: .5rem;}.p-facts li li::after { content: ',';}.p-facts li li:last-child::after { content: '';}/* Parts:crumb */.p-crumb { list-style: none; margin-bottom: 1rem; font-size: .8rem; text-transform: uppercase; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.p-crumb:last-child { margin-bottom: 0;}.p-crumb li { display: inline;}.p-crumb li::after { content: '›'; margin: 0 .5rem;}.p-crumb li:last-child::after { content: '';}/* Parts:page-title */.p-page-title { margin-bottom: 2rem;}.p-page-title .title { margin-bottom: .5rem;}/* Parts:share */.p-share { margin-bottom: 1.5rem;}.p-share a { display: inline-block; text-align: center; padding: .5rem .5rem; margin-right: .25rem; font-size: .6rem; background-color: #eceff1; font-weight: 700k}.p-share a.ht { color: #00a4de; }.p-share a.fb { color: #3b5998; }.p-share a.tw { color: #1da1f2; }.p-share a.gp { color: #dd4b39; }.p-share a.ln { color: #00c300; }.p-share a.ht::before { content: 'Hatena'; }.p-share a.fb::before { content: 'Facebook'; }.p-share a.tw::before { content: 'Twitter'; }.p-share a.gp::before { content: 'Google+'; }.p-share a.ln::before { content: 'LINE'; }/* Parts:terms */.p-terms { padding-left: 2rem;}/* Parts:paginator */.p-paginator { text-align: center; margin-bottom: 3rem; padding-top: 2rem;}.p-paginator a { display: inline-block; border: 2px solid #eceff1; color: #263238; line-height: 2rem; padding: 0 1rem;}/* Parts:article */.p-articles { list-style: none;}.p-articles>li { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px dashed #cfd8dc;}.p-articles>li:last-child { border-bottom: none; padding-bottom: 0;}.p-articles.thin>li { margin-bottom: 1rem; padding-bottom: 1rem;}article .article-header { display: table-cell; height: 6rem; vertical-align: middle;}article .title { margin: 0; margin-bottom: .5rem; font-size: 1.4rem; line-height: 2rem;}article .title a { color: #000;}article .header-wrapper { margin-bottom: 1.5rem;}article .thumbnail { display: none;}article .summary { margin-bottom: 1.5rem;}article .readmore { text-align: center;}article .readmore a { font-size: .8rem; color: #000; text-decoration: underline;}article.li.sm .header-wrapper { margin-bottom: 0;}.article-body h2 { padding: 1rem 0; border-bottom: 2px solid #eceff1;}.article-body h2:first-child { margin-top: 0; }.article-body h3 { color: #cddc39;}.article-body h4 { border-left: solid .25rem #cddc39; padding: 0 .5rem;}.article-body p { margin: 1.5rem 0; line-height: 1.5rem;}.article-body a { text-decoration: underline;}.article-body ul,.article-body ol { padding-left: 1.5rem;}.article-body code { display: inline-block; font-family: Menlo, consolas, monospace; background-color: #eceff1; font-size: .8rem; padding: 0 .5rem; line-height: 1.5rem;}.article-body pre { margin: 1.5rem 0; padding: 1.5rem; font-size: .8rem; background-color: #263238; color: #fff; overflow: auto;}.article-body pre code { background-color: transparent;}.article-body blockquote { margin: 1.5rem 0; padding: .5rem 0; font-size: .8rem; border-top: 1px solid #eceff1; border-bottom: 1px solid #eceff1; color: #607d8b;}.article-body blockquote p { margin: .5rem 0; line-height: 1rem;}.article-body strong { box-shadow: 0 -.5rem 0 0 #f06292 inset;}.article-body em { font-style: normal; font-weight: 700; color: #ff5722;}.article-body figure { margin: 1.5rem -2rem; }.article-body figure.left,.article-body figure.right { width: 15rem; height: 12rem; margin-top: 0; margin-left: 0; margin-right: 0;}.article-body figure.left { float: left; margin-right: 1rem; margin-left: -2rem; }.article-body figure.right { float: right; margin-left: 1rem; margin-right: -2rem; }@media (max-width: 768px) { .article-body figure { margin: 1.5rem -1rem; } .article-body figure.left, .article-body figure.right { float: none; margin: 0 -1rem; width: auto; height: auto; }}.article-body figcaption { padding: .5rem 0; font-size: .8rem; text-align: center;}.article-body figcaption a { color: #263238;}img { max-width: 100%;}

      
    </style>
  </head>

  <body>
    
    
    <amp-analytics type="googleanalytics" id="analytics1">
      <script type="application/json">
        {
          "vars": {
            "account": "UA-18060688-3"
          },
          "triggers": {
            "trackPageview": {
              "on": "visible",
              "request": "pageview"
            }
          }
        }
      </script>
    </amp-analytics>
    
    

    <header class="l-header">
      <div class="l-container">
        <div class="h-logo p-logo">
          <a href="https://blog.mgechev.com/" class="h-logo">Minko Gechev&apos;s blog</a>
        </div>
      </div>
    </header>

    <main>
      
<div class="l-container">
  <article class="single article-98df38e6e04fdc62075014d567f53fcd">
  <div class="header-wrapper">
    <a href="https://blog.mgechev.com/2013/08/07/aspect-oriented-programming-with-javascript-angularjs/" class="thumbnail" title="Aspect-Oriented Programming with AngularJS"></a>
    <header class="article-header">
      <div class="clearfix">
        <h1 class="title">Aspect-Oriented Programming with AngularJS</h1>
        <ul class="p-facts">
          <li><time datetime="2013-08-07T00:00:00JST">Aug 7, 2013</time></li>
          <li><a href="https://blog.mgechev.com/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>

  <aside class="p-share">
  <a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.mgechev.com%2f2013%2f08%2f07%2faspect-oriented-programming-with-javascript-angularjs%2f&amp;t=Aspect-Oriented%20Programming%20with%20AngularJS" title="Facebook&#x3067;&#x30B7;&#x30A7;&#x30A2;" class="fb" target="_blank" rel="nofollow"></a>
  <a href="http://twitter.com/intent/tweet?url=https%3a%2f%2fblog.mgechev.com%2f2013%2f08%2f07%2faspect-oriented-programming-with-javascript-angularjs%2f&amp;text=Aspect-Oriented%20Programming%20with%20AngularJS&amp;tw_p=tweetbutton" title="Twitter&#x3067;&#x30B7;&#x30A7;&#x30A2;" class="tw" target="_blank" rel="nofollow"></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fblog.mgechev.com%2f2013%2f08%2f07%2faspect-oriented-programming-with-javascript-angularjs%2f" title="Google Plus&#x3067;&#x30B7;&#x30A7;&#x30A2;" class="gp" target="_blank" rel="nofollow"></a>
</aside>


  <div class="article-body">

<p>In the following blog post I&#x2019;ll write few words about what is Aspect-Oriented Programming, why I think it will be useful in AngularJS and I&#x2019;m also going to give you a short tutorial for using a <a title="GitHub" href="https://github.com/mgechev/angular-aop" target="_blank">simple AOP framework I&#x2019;ve developed</a>.</p>

<p>First things first. What is AOP? As we all know OOP is awesome! It gives us many tools for making our development process simpler. Its core principles are Abstraction, Encapsulation, Inheritance and Polymorphism.</p>

<p>Abstraction helps us build complex applications without thinking for all details. We just &#x201C;find&#x201D; the correct level of abstraction for the current phase of development and use it until it&#x2019;s useful for us. For example when we develop complex OS the first (or one of the first) levels of abstraction, I guess, will include creating a facade for all different hardware platforms but after that the hardware differences wont matter for us and we&#x2019;ll use higher level interface.</p>

<p>Encapsulation and abstraction are complementary concepts. Encapsulation gives us more details about the implementation behind the visible interface which is our abstraction of the given class or object.</p>

<p>Inheritance gives us code reuse, and polymorphism gives us a common way of handling different instances of different classes in the same hierarchy (and few more things but let&#x2019;s stop here).</p>

<p>But what we don&#x2019;t have?</p>

<p>Let&#x2019;s define the concept of cross-cutting concern:</p>

<blockquote cite="https://en.wikipedia.org/wiki/Cross-cutting_concern">
  <p>
    In computer science, cross-cutting concerns are aspects of a program that affect other concerns. These concerns often cannot be cleanly decomposed from the rest of the system in both the design and implementation, and can result in either scattering (code duplication), tangling (significant dependencies between systems), or both.
  </p>
</blockquote>

<p>The most common examples for cross-cutting concerns are logging, authentication and transactions.<br>
Let&#x2019;s focus in logging. We may need to log different informations when different methods are called. That means we should have things like:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&apos;log before&apos;</span><span class="p">);</span>
  <span class="c1">//body
</span><span class="c1"></span>  <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&apos;log after&apos;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>If we change the interface of our logger we should change it everywhere, this may affect hundreds of different files.<br>
The situation can become even more complex if we add authentication:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">Authotization</span><span class="p">.</span><span class="nx">isAuthorized</span><span class="p">();</span>
    <span class="c1">//body
</span><span class="c1"></span>  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//handle the error
</span><span class="c1"></span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>It may look ok for one or few functions/methods but if their count increase you can shoot yourself in the foot with so many duplicates.<br>
OOP don&#x2019;t gives us tools for handling such problems. It may suggest to create few helper classes and just copy and paste pieces of code from one place to another.</p>

<p>In AOP we have few more concepts: joint-point &#x2013; this is place where something happen. For example call of procedure, return of result by a function, throw of exception, call of constructor, etc.</p>

<p>We have also pointcuts. Pointscuts help us describe one or more joint-points. The last concept I&#x2019;ll define are the advices. They are pieces of code which will be executed in given moment (when joint-points is encountered during the program runs).</p>

<p>To show you how AOP can be useful in AngularJS let me introduce you <a title="GitHub" href="https://github.com/mgechev/angular-aop" target="_blank">AngularAOP</a>.</p>

<h2 id="angularaop">AngularAOP</h2>

<p>You can define the cross-cutting concerns in separate services. For example here is a definition of logging service which logs the method calls and thrown exceptions:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">DemoApp</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">&apos;Logger&apos;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">exception</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&apos;%cException: &apos;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">exception</span><span class="p">.</span><span class="nx">message</span> <span class="o">+</span> <span class="s1">&apos;. &apos;</span>
                <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">method</span> <span class="o">+</span> <span class="s1">&apos; called before proper authorization.&apos;</span><span class="p">,</span>
                <span class="s1">&apos;color: red; text-weight: bold; font-size: 1.2em;&apos;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">throwData</span> <span class="o">=</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">exception</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&apos; and threw: &apos;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">exception</span><span class="p">.</span><span class="nx">message</span> <span class="o">:</span> <span class="s1">&apos;&apos;</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&apos;Method: &apos;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">method</span> <span class="o">+</span> <span class="s1">&apos;, Pointcut: &apos;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">when</span> <span class="o">+</span> <span class="s1">&apos;, with arguments: &apos;</span> <span class="o">+</span>
                    <span class="nx">angular</span><span class="p">.</span><span class="nx">toJson</span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">args</span><span class="p">)</span> <span class="o">+</span> <span class="nx">throwData</span><span class="p">);</span>
    <span class="p">};</span>
<span class="p">});</span>
</code></pre></div>

<p>The definition of that service doesn&#x2019;t differ from the usual service definition.<br>
Here is definition of one more service which can cause problems with the code maintenance because it is a cross-cutting concern:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">DemoApp</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">&apos;Authorization&apos;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">User</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">User</span><span class="p">.</span><span class="nx">getUsername</span><span class="p">()</span> <span class="o">!==</span> <span class="s1">&apos;foo&apos;</span> <span class="o">&amp;&amp;</span>
            <span class="nx">User</span><span class="p">.</span><span class="nx">getPassword</span><span class="p">()</span> <span class="o">!==</span> <span class="s1">&apos;bar&apos;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&apos;Not authorized&apos;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">});</span>
</code></pre></div>

<p>The given service just checks whether user&#x2019;s user name and password are equal respectively to &#x201C;foo&#x201D; and &#x201C;bar&#x201D;, if they are not equal to these values the service throws an Error(&#x2018;Not authorized&#x2019;).</p>

<p>We may want to apply authorization for reading news:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">DemoApp</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">&apos;ArticlesCollection&apos;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$q</span><span class="p">,</span> <span class="nx">$timeout</span><span class="p">,</span> <span class="nx">execute</span><span class="p">,</span> <span class="nx">Logger</span><span class="p">,</span> <span class="nx">Authorization</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">sampleArticles</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&apos;Title 1&apos;</span><span class="p">,</span> <span class="nx">content</span><span class="o">:</span> <span class="s1">&apos;Content 1&apos;</span> <span class="p">},</span>
            <span class="p">{</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&apos;Title 2&apos;</span><span class="p">,</span> <span class="nx">content</span><span class="o">:</span> <span class="s1">&apos;Content 2&apos;</span> <span class="p">},</span>
            <span class="p">{</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&apos;Title 3&apos;</span><span class="p">,</span> <span class="nx">content</span><span class="o">:</span> <span class="s1">&apos;Content 3&apos;</span> <span class="p">}</span>
        <span class="p">],</span>
        <span class="nx">privateArticles</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&apos;Title 4&apos;</span><span class="p">,</span> <span class="nx">content</span><span class="o">:</span> <span class="s1">&apos;Content 4&apos;</span> <span class="p">},</span>
            <span class="p">{</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&apos;Title 5&apos;</span><span class="p">,</span> <span class="nx">content</span><span class="o">:</span> <span class="s1">&apos;Content 5&apos;</span> <span class="p">}</span>
        <span class="p">],</span>
        <span class="nx">api</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">loadArticles</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">$q</span><span class="p">.</span><span class="nx">defer</span><span class="p">();</span>
                <span class="nx">$timeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                    <span class="nx">deferred</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">sampleArticles</span><span class="p">);</span>
                <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
                <span class="k">return</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">promise</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">getArticleById</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">sampleArticles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">sampleArticles</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">)</span>  <span class="p">{</span>
                        <span class="k">return</span> <span class="nx">sampleArticles</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">getPrivateArticles</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">privateArticles</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="k">return</span> <span class="nx">api</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>

<p>This is simple service which contains two kinds of articles (simple object literals): sampleArticles and privateArticles. The api object is the actual service public interface.</p>

<p>We may want to apply authorization to the private articles, before the getPrivateArticles method return its result. The usual way to do it is:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">getPrivateArticles</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">Authorization</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">privateArticles</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>We may also want to apply authorization to the getArticleById method, so:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">getArticleById</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Authorization</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">sampleArticles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">sampleArticles</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">)</span>  <span class="p">{</span>
            <span class="k">return</span> <span class="nx">sampleArticles</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>We have two duplicate lines of code. At this moment it&#x2019;s not a big deal but we may want to add logging and see special error message in the console when Error is thrown:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">//...
</span><span class="c1"></span><span class="nx">getPrivateArticles</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="nx">Authorization</span><span class="p">();</span>
        <span class="k">return</span> <span class="nx">privateArticles</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&apos;%cException: &apos;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">message</span> <span class="o">+</span> <span class="s1">&apos;. getPrivateArticles called before proper authorization.&apos;</span><span class="p">,</span>
            <span class="s1">&apos;color: red; text-weight: bold; font-size: 1.2em;&apos;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="nx">getArticleById</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="nx">Authorization</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">sampleArticles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">sampleArticles</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">)</span>  <span class="p">{</span>
                <span class="k">return</span> <span class="nx">sampleArticles</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&apos;%cException: &apos;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">message</span> <span class="o">+</span> <span class="s1">&apos;. getArticleById called before proper authorization.&apos;</span><span class="p">,</span>
            <span class="s1">&apos;color: red; text-weight: bold; font-size: 1.2em;&apos;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//...
</span></code></pre></div>

<p>Now we have a lot of duplicates and if we want to change something in the code which authorises the user and logs the error we should change it in both places. We may have service with large interface which requires logging and authorisation (or something else) in all of its methods or big part of them. In this case we need something more powerful and the Aspect-Oriented Programming gives us the tools for that.</p>

<p>We can achieve the same effect as in the code above just by applying Authorization and Logger service to the api object:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">return</span> <span class="nx">execute</span><span class="p">(</span><span class="nx">Logger</span><span class="p">).</span><span class="nx">onThrowOf</span><span class="p">(</span><span class="nx">execute</span><span class="p">(</span><span class="nx">Authorization</span><span class="p">).</span><span class="nx">before</span><span class="p">(</span><span class="nx">api</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">methodPattern</span><span class="o">:</span> <span class="sr">/Special|getArticleById/</span>
<span class="p">}));</span>
</code></pre></div>

<p>This code will invoke the Authorization service before executing the methods which match the pattern: /Special|getArticleById/ when an Error is thrown the Logger will log it with detailed information. Notice that onThrowOf, before and all the methods listed below return object with the same methods so chaining is possible. We can also match the methods not only by their names but also by their arguments:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">return</span> <span class="nx">execute</span><span class="p">(</span><span class="nx">Logger</span><span class="p">).</span><span class="nx">onThrowOf</span><span class="p">(</span><span class="nx">execute</span><span class="p">(</span><span class="nx">Authorization</span><span class="p">).</span><span class="nx">before</span><span class="p">(</span><span class="nx">api</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">methodPattern</span><span class="o">:</span> <span class="sr">/Special|getArticleById/</span><span class="p">,</span>
    <span class="nx">argsPatterns</span><span class="o">:</span> <span class="p">[</span><span class="sr">/^user$, /</span><span class="o">^</span><span class="p">[</span><span class="nx">Ii</span><span class="p">]</span><span class="nx">d</span><span class="p">(</span><span class="nx">_num</span><span class="p">)</span><span class="o">?</span><span class="nx">$</span><span class="o">/</span><span class="p">]</span>
<span class="p">}));</span>
</code></pre></div>

<p>Now the aspects will be applied only to the methods which match both the methodPattern and argsPatterns rules.</p>

<p>Currently execute supports the following pointcuts:</p>

<ul>
<li>before &#x2013; executes given service before the matched methods are invoked.</li>
<li>after &#x2013; executes given service after the matched methods are invoked.</li>
<li>around &#x2013; executes given service before and after the matched methods are invoked.</li>
<li>onThrowOf &#x2013; executes when an Error is thrown by method from the given set of matched methods.</li>
<li>onResolveOf &#x2013; executes after promise returned by a method from the given set of matched methods is resolved but before the resolve callback is invoked.</li>
<li>afterResolveOf &#x2013; executes after promise returned by a method from the given set of matched methods is resolved but after the resolve callback is invoked.</li>
<li>onRejectOf &#x2013; executes after promise returned by a method from the given set of matched methods is rejected.</li>
</ul>

<p>Aspects can be applied not only to objects but also to functions:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">DemoApp</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">&apos;ArticlesCollection&apos;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$q</span><span class="p">,</span> <span class="nx">$timeout</span><span class="p">,</span> <span class="nx">execute</span><span class="p">,</span> <span class="nx">Logger</span><span class="p">,</span> <span class="nx">Authorization</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">execute</span><span class="p">(</span><span class="nx">Logger</span><span class="p">).</span><span class="nx">before</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="c1">//body
</span><span class="c1"></span>    <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>

<p><a title="GitHub" href="https://github.com/mgechev/angular-aop" target="_blank">AngularAOP</a> can be found at: <a title="GitHub" href="https://github.com/mgechev/angular-aop" target="_blank">GitHub</a></p>
</div>

  <aside class="p-share">
  <a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.mgechev.com%2f2013%2f08%2f07%2faspect-oriented-programming-with-javascript-angularjs%2f&amp;t=Aspect-Oriented%20Programming%20with%20AngularJS" title="Facebook&#x3067;&#x30B7;&#x30A7;&#x30A2;" class="fb" target="_blank" rel="nofollow"></a>
  <a href="http://twitter.com/intent/tweet?url=https%3a%2f%2fblog.mgechev.com%2f2013%2f08%2f07%2faspect-oriented-programming-with-javascript-angularjs%2f&amp;text=Aspect-Oriented%20Programming%20with%20AngularJS&amp;tw_p=tweetbutton" title="Twitter&#x3067;&#x30B7;&#x30A7;&#x30A2;" class="tw" target="_blank" rel="nofollow"></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fblog.mgechev.com%2f2013%2f08%2f07%2faspect-oriented-programming-with-javascript-angularjs%2f" title="Google Plus&#x3067;&#x30B7;&#x30A7;&#x30A2;" class="gp" target="_blank" rel="nofollow"></a>
</aside>


  <footer class="article-footer">
    <section>
      <ol class="p-crumb">
        <li><a href="https://blog.mgechev.com/">Minko Gechev&apos;s blog</a></li>
        
        <li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="https://blog.mgechev.com/post/" itemprop="url"><span itemprop="title">post</span></a></li>
        
        <li>Aspect-Oriented Programming with AngularJS</li>
      </ol>

      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="https://blog.mgechev.com/categories/">categories</a></header>
          <ul>
            
            <li><a href="https://blog.mgechev.com/categories/AngularJS/">AngularJS</a></li>
            
            <li><a href="https://blog.mgechev.com/categories/Aspect-Oriented-Programming/">Aspect-Oriented Programming</a></li>
            
            <li><a href="https://blog.mgechev.com/categories/Computer-science/">Computer science</a></li>
            
            <li><a href="https://blog.mgechev.com/categories/Development/">Development</a></li>
            
            <li><a href="https://blog.mgechev.com/categories/Internet/">Internet</a></li>
            
            <li><a href="https://blog.mgechev.com/categories/JavaScript/">JavaScript</a></li>
            
            <li><a href="https://blog.mgechev.com/categories/Object-Oriented-Programming/">Object-Oriented Programming</a></li>
            
            <li><a href="https://blog.mgechev.com/categories/Patterns/">Patterns</a></li>
            
            <li><a href="https://blog.mgechev.com/categories/Programming/">Programming</a></li>
            
            <li><a href="https://blog.mgechev.com/categories/Programming-languages/">Programming languages</a></li>
            
          </ul>
        </li>
      </ul>
      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="https://blog.mgechev.com/tags/">tags</a></header>
          <ul>
            
            <li><a href="https://blog.mgechev.com/tags/AngularJS/">AngularJS</a></li>
            
            <li><a href="https://blog.mgechev.com/tags/aop/">aop</a></li>
            
            <li><a href="https://blog.mgechev.com/tags/aspect-oriented-programming/">aspect-oriented programming</a></li>
            
            <li><a href="https://blog.mgechev.com/tags/Computer-science/">Computer science</a></li>
            
            <li><a href="https://blog.mgechev.com/tags/Development/">Development</a></li>
            
            <li><a href="https://blog.mgechev.com/tags/Internet/">Internet</a></li>
            
            <li><a href="https://blog.mgechev.com/tags/JavaScript/">JavaScript</a></li>
            
            <li><a href="https://blog.mgechev.com/tags/Programming/">Programming</a></li>
            
            <li><a href="https://blog.mgechev.com/tags/programming-languages/">programming languages</a></li>
            
            <li><a href="https://blog.mgechev.com/tags/Projects/">Projects</a></li>
            
          </ul>
        </li>
      </ul>
      
      
    </section>
  </footer>
</article>



  
  
  <section>
    <header><span>Latests</span></header>
    <ul class="p-articles thin">
      <li><article class="li sm article-44f7e855bf61587b948c61a813fbc0b6">
  <div class="header-wrapper">
    <a href="https://blog.mgechev.com/2021/01/18/design-pattens-in-open-source-projects-part-i/" class="thumbnail" title="Design Patterns in Open Source Projects - Part I"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://blog.mgechev.com/2021/01/18/design-pattens-in-open-source-projects-part-i/">Design Patterns in Open Source Projects - Part I</a></h2>
        <ul class="p-facts">
          <li><time datetime="2021-01-18T00:00:00JST">Jan 18, 2021</time></li>
          <li><a href="https://blog.mgechev.com/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-fb9219e3e82481c8d0ecc34aefa48327">
  <div class="header-wrapper">
    <a href="https://blog.mgechev.com/2020/11/26/what-i-learned-doing-100-public-talks-part-i/" class="thumbnail" title="What I learned doing 125 public talks - Part I"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://blog.mgechev.com/2020/11/26/what-i-learned-doing-100-public-talks-part-i/">What I learned doing 125 public talks - Part I</a></h2>
        <ul class="p-facts">
          <li><time datetime="2020-11-26T00:00:00JST">Nov 26, 2020</time></li>
          <li><a href="https://blog.mgechev.com/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-1157e7059d1a22160f8b0a59f36bbe97">
  <div class="header-wrapper">
    <a href="https://blog.mgechev.com/2019/05/11/dynamic-imports-javascript/" class="thumbnail" title="Dynamic imports solve all the problems, right?"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://blog.mgechev.com/2019/05/11/dynamic-imports-javascript/">Dynamic imports solve all the problems, right?</a></h2>
        <ul class="p-facts">
          <li><time datetime="2019-05-11T00:00:00JST">May 11, 2019</time></li>
          <li><a href="https://blog.mgechev.com/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li>
    </ul>
  </section>
  
</div>


    </main>

    

    <footer class="l-footer">
      <div class="l-container">
        <p><span class="h-logo">&#xA9; Minko Gechev&apos;s blog</span></p>
      </div>
    </footer>

    <a href="#" class="p-movetop" title="&#x30DA;&#x30FC;&#x30B8;&#x4E0A;&#x90E8;&#x3078;&#x623B;&#x308B;" rel="nofollow"></a>
  </body>
</html>

